import e,{useRef as n,useState as t,useEffect as o,forwardRef as r,useImperativeHandle as l}from"react";import{HtmlUtils as i}from"@delpi/common";import c from"perfect-scrollbar";var a=function(){return a=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},a.apply(this,arguments)};function s(e,n,t,o){return new(t||(t=Promise))(function(r,l){function i(e){try{a(o.next(e))}catch(e){l(e)}}function c(e){try{a(o.throw(e))}catch(e){l(e)}}function a(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(i,c)}a((o=o.apply(e,n||[])).next())})}function u(e,n){var t,o,r,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(a){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(l=0)),l;)try{if(t=1,o&&(r=2&c[0]?o.return:c[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,c[1])).done)return r;switch(o=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return l.label++,{value:c[1],done:!1};case 5:l.label++,o=c[1],c=[0];continue;case 7:c=l.ops.pop(),l.trys.pop();continue;default:if(!(r=l.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){l=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){l.label=c[1];break}if(6===c[0]&&l.label<r[1]){l.label=r[1],r=c;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(c);break}r[2]&&l.ops.pop(),l.trys.pop();continue}c=n.call(e,l)}catch(e){c=[6,e],o=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}}"function"==typeof SuppressedError&&SuppressedError;var d=function(e,n,t,o){if(void 0===o&&(o=.95),!n.raf){var r=function(){var l=n.vx,i=n.vy;if(Math.abs(l)<.1&&Math.abs(i)<.1)return n.raf=null,void(null==t||t.forEach(function(n){var t;return null===(t=n.onScrollStop)||void 0===t?void 0:t.call(n,e)}));e.scrollLeft+=Math.sign(l)*Math.min(Math.abs(l),50),e.scrollTop+=Math.sign(i)*Math.min(Math.abs(i),50),n.vx*=o,n.vy*=o,null==t||t.forEach(function(n){var t;return null===(t=n.onScroll)||void 0===t?void 0:t.call(n,e)}),n.raf=requestAnimationFrame(r)};null==t||t.forEach(function(n){var t;return null===(t=n.onScrollStart)||void 0===t?void 0:t.call(n,e)}),n.raf=requestAnimationFrame(r)}},v=new WeakMap,f=function(e){return.5-Math.cos(e*Math.PI)/2},p=function(e,n,t){var o="y"===n?"ps--scrolling-y":"ps--scrolling-x";t?e.classList.add(o):e.classList.remove(o)},h=function(e,n,t){if(void 0===t&&(t={}),e){var o=t.duration,r=void 0===o?300:o,l=t.easing,i=void 0===l?f:l;v.has(e)&&(cancelAnimationFrame(v.get(e)),v.delete(e));var c=e.scrollTop,a=n-c;if(0!==a){var s=performance.now();p(e,"y",!0);var u=function(t){var o=t-s,l=Math.min(o/r,1),d=Math.max(0,Math.min(1,i(l)));if(l>0&&(e.scrollTop=c+a*d),l<1){var f=requestAnimationFrame(u);v.set(e,f)}else v.delete(e),e.scrollTop=n,p(e,"y",!1)},d=requestAnimationFrame(u);v.set(e,d)}else e.scrollTop=n}},m=function(e,n,t){if(void 0===t&&(t={}),e){var o=t.duration,r=void 0===o?300:o,l=t.easing,i=void 0===l?f:l;v.has(e)&&(cancelAnimationFrame(v.get(e)),v.delete(e));var c=e.scrollLeft,a=n-c;if(0!==a){var s=performance.now();p(e,"x",!0);var u=function(t){var o=t-s,l=Math.min(o/r,1),d=Math.max(0,Math.min(1,i(l)));if(l>0&&(e.scrollLeft=c+a*d),l<1){var f=requestAnimationFrame(u);v.set(e,f)}else v.delete(e),e.scrollLeft=n,p(e,"x",!1)},d=requestAnimationFrame(u);v.set(e,d)}else e.scrollLeft=n}},y=function(e,n){if(void 0===n&&(n={}),e){var t=e.scrollHeight-e.clientHeight;h(e,t,n)}},g=function(e,n){void 0===n&&(n={}),e&&h(e,0,n)},b=function(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];null==e||e.forEach(function(e){var o=e[n];o&&o.apply(void 0,t)})},S=function(e,n,t,o,r,l,i){void 0===r&&(r=!1),void 0===l&&(l=.95);var c=function(){var n;return null===(n=e.current)||void 0===n?void 0:n.element},a=null,s=function(){o&&(o.vx=0,o.vy=0)},u=function(e,a,u,v,f){void 0===u&&(u=null!=n?n:300),void 0===v&&(v=null!=t?t:function(e){return e}),void 0===f&&(f=!1);var p=c();p&&o&&(f?(void 0!==e&&(o.vx=e-p.scrollLeft),void 0!==a&&(o.vy=a-p.scrollTop)):s(),void 0!==e&&m(p,e,{duration:u,easing:v}),void 0!==a&&h(p,a,{duration:u,easing:v}),b(i,"onScroll",p),r&&f&&d(p,o,i,l),void 0!==a&&(a<=0&&b(i,"onReachTop"),a+p.clientHeight>=p.scrollHeight&&b(i,"onReachBottom"),a+p.clientHeight>=.9*p.scrollHeight&&b(i,"onReachThreshold",90)),void 0!==e&&(e<=0&&b(i,"onReachLeft"),e+p.clientWidth>=p.scrollWidth&&b(i,"onReachRight")))},v={update:function(){var n;return null===(n=e.current)||void 0===n?void 0:n.update()},destroy:function(){var n;null===(n=e.current)||void 0===n||n.destroy(),b(i,"onDestroy"),a&&c()&&c().removeEventListener("scroll",a),s()},getScrollbar:function(){var n;return null!==(n=e.current)&&void 0!==n?n:null},getScrollElement:function(){var e;return null!==(e=c())&&void 0!==e?e:null},resetMomentum:s,scrollToX:function(e,n,t){return u(e,void 0,n,t)},scrollToY:function(e,n,t){return u(void 0,e,n,t)},scrollToTop:function(e,n){return u(void 0,0,e,n)},scrollToBottom:function(e,n){var t=c();t&&u(void 0,t.scrollHeight,e,n)},scrollToLeft:function(e,n){return u(0,void 0,e,n)},scrollToRight:function(e,n){var t=c();t&&u(t.scrollWidth,void 0,e,n)},scrollToIndex:function(e,n,t){var o=c();if(o){var r=o.children[e];r&&u(void 0,r.offsetTop,n,t)}},scrollToElement:function(e,n,t){c()&&e&&u(void 0,e.offsetTop,n,t)},scrollToPercent:function(e,o,r,l){void 0===r&&(r=null!=n?n:500),void 0===l&&(l=null!=t?t:function(e){return e});var i=c();if(i){var a=void 0!==e?(i.scrollHeight-i.clientHeight)*e:void 0,s=void 0!==o?(i.scrollWidth-i.clientWidth)*o:void 0;u(s,a,r,l)}}},f=c();return f&&(b(i,"onInit",v,f),a=function(){b(i,"onScroll",f)},f.addEventListener("scroll",a)),v},E={"ps-scroll-y":"onScrollY","ps-scroll-x":"onScrollX","ps-scroll-up":"onScrollUp","ps-scroll-down":"onScrollDown","ps-scroll-left":"onScrollLeft","ps-scroll-right":"onScrollRight","ps-y-reach-start":"onYReachStart","ps-y-reach-end":"onYReachEnd","ps-x-reach-start":"onXReachStart","ps-x-reach-end":"onXReachEnd"},w=function(e){var n=e.height,t=e.maxHeight,o=e.width,r=e.maxWidth,l=function(e){return void 0===e?void 0:"number"==typeof e?"".concat(e,"px"):e};return a(a(a(a({},n?{height:l(n)}:{}),t?{maxHeight:l(t)}:{}),o?{width:l(o)}:{}),r?{maxWidth:l(r)}:{})},x=function(e,n){var t={};return n?(Object.entries(E).forEach(function(o){var r=o[0],l=o[1],i=e[l];i&&(t[r]=function(e){return i(e)},n.addEventListener(r,t[r]))}),t):t},T=function(e,n){void 0===e&&(e={}),Object.entries(e).forEach(function(e){var t=e[0],o=e[1];n.removeEventListener(t,o)})},L=function(e,n,t){var o;if(!e.current)return{el:null};if(t){var r=e.current.querySelector("table"),l=null!==(o=null==r?void 0:r.querySelector("tbody"))&&void 0!==o?o:null;if(l)return Object.entries(n).forEach(function(e){var n=e[0],t=e[1];l.style[n]=t}),{table:null!=r?r:void 0,el:l}}return{el:e.current}},A=function(e,n){return Array.from(e).filter(function(e){return!n.includes(e)})},H=function(e){return void 0===e&&(e=[]),e.reduce(function(e,n){return e+n.clientHeight},0)},M=function(e,n,t){var o=(null!=t?t:i.findFirstLevel(e,n)).filter(i.isVisible);return o.length?o[o.length-1]:null};function I(e,r){var l,i=e.options,s=e.always,u=e.wheelStop,v=e.injectTable,f=e.effectData,p=e.autoScrollBottom,m=e.autoScrollToNewItem,y=e.preserveScroll,g=e.scrollSaveKey,b=e.disableKeyboard,E=e.scrollDuration,A=e.scrollEasing,H=e.plugins,M=void 0===H?[]:H,I=e.inertia,R=void 0===I||I,k=e.inertiaFriction,F=e.scrollLock,D=e.onScroll,q=e.onScrollStart,C=e.onScrollStop,O=e.onScrollDirectionChange,P=e.onUserScroll,j=e.onReachTop,z=e.onReachBottom,N=e.onReachLeft,Y=e.onReachRight,W=e.onReachStart,B=e.onReachEnd,U=e.onReachThreshold,X=function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]])}return t}(e,["options","always","wheelStop","injectTable","effectData","autoScrollBottom","autoScrollToNewItem","preserveScroll","scrollSaveKey","disableKeyboard","scrollDuration","scrollEasing","plugins","inertia","inertiaFriction","scrollLock","onScroll","onScrollStart","onScrollStop","onScrollDirectionChange","onUserScroll","onReachTop","onReachBottom","onReachLeft","onReachRight","onReachStart","onReachEnd","onReachThreshold"]),K=n(null),_=n(null),G=n({x:0,y:0}),J=n(null),V=n({x:0,y:0}),Q=n({vx:0,vy:0,raf:null}),Z=n(null),$=t(!1),ee=$[0],ne=$[1],te=w(X),oe=null!==(l=null==i?void 0:i.wheelPropagation)&&void 0!==l?l:u;return o(function(){if(_.current){var e=L(_,te,v),n=e.table,t=e.el,o=a(a({},i||{}),{wheelPropagation:oe});n&&(K.current=t,o.suppressScrollX=!0,n.classList.add("list-dk-scroll-view","perfect-table"),s&&(null==t||t.classList.add("scroll-always")),oe&&(null==t||t.classList.add("scroll-wheel-stop"))),Z.current=new c(t,o),F&&t&&(t.style.overflow="hidden");var l=x(X,t);if(g){var u=sessionStorage.getItem(g);if(u){var f=JSON.parse(u),h=f.x,m=f.y;t.scrollTop=m,t.scrollLeft=h}}y&&(t.scrollTop=G.current.y,t.scrollLeft=G.current.x),p&&(t.scrollTop=t.scrollHeight);var w=function(e){if(b){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"," "].includes(e.key)&&e.preventDefault()}};b&&window.addEventListener("keydown",w);var H={x:0,y:0},I=function(e){var n=t,o=n.scrollLeft,r=n.scrollTop,l="wheel"===e.type||"touchmove"===e.type;null==D||D({x:o,y:r}),R&&l&&(Q.current.vx=o-V.current.x,Q.current.vy=r-V.current.y,d(n,Q.current,M,k)),q&&(J.current?clearTimeout(J.current):q()),C&&(J.current&&clearTimeout(J.current),J.current=window.setTimeout(function(){J.current=null,C()},150)),o-H.x===0&&r-H.y===0||!O||(O({x:o-H.x,y:r-H.y}),H={x:o,y:r}),null==P||P({x:o,y:r});var i=.9*n.scrollHeight;if(U&&r+n.clientHeight>=i&&U(90),z&&r+n.clientHeight>=n.scrollHeight&&z(),j&&r<=0&&j(),B&&r+n.clientHeight>=n.scrollHeight&&B(),W&&r<=0&&W(),Y&&o+n.clientWidth>=n.scrollWidth&&Y(),N&&o<=0&&N(),V.current={x:o,y:r},R&&t){var c=Q.current,a=c.vx,s=c.vy;(Math.abs(a)>.1||Math.abs(s)>.1)&&requestAnimationFrame(function(){t.scrollLeft+=a,t.scrollTop+=s,Q.current.vx*=null!=k?k:.95,Q.current.vy*=null!=k?k:.95})}};t.addEventListener("scroll",I),r&&(r.current=S(Z,E,A,Q.current,R,k,M));var $=new ResizeObserver(function(){var e;return null===(e=Z.current)||void 0===e?void 0:e.update()});return $.observe(t),window.addEventListener("resize",function(){var e;return null===(e=Z.current)||void 0===e?void 0:e.update()}),function(){var e;if(y&&Z.current){var n=Z.current.element;G.current={x:n.scrollLeft,y:n.scrollTop}}T(l,t),t.removeEventListener("scroll",I),$.disconnect(),window.removeEventListener("resize",function(){var e;return null===(e=Z.current)||void 0===e?void 0:e.update()}),b&&window.removeEventListener("keydown",w),null===(e=Z.current)||void 0===e||e.destroy(),Q.current.raf&&cancelAnimationFrame(Q.current.raf)}}},[_.current,f]),o(function(){if(Z.current&&_.current){var e=Z.current.element;Z.current.update(),m&&h(e,e.scrollHeight,{duration:E,easing:A})}},[f,e.children]),{refsTarget:_,hovering:ee,setHovering:ne,dimension:te,getApi:function(){return S(Z,E,A,Q.current,R,k,M)},plugins:M}}var R=r(function(n,t){var o,r,c=I(n,t&&"function"!=typeof t?t:void 0),s=c.refsTarget,u=c.hovering,d=c.setHovering,v=c.dimension,f=c.getApi,p=c.plugins;l(t,f);var h=i.joinClass("list-dk-scroll-view","perfect-list",n.className,n.autoHide&&!u?"scroll-hidden":void 0),m=i.joinClass("scroll-content",{"scroll-always":n.always},{"scroll-wheel-stop":null!==(r=null===(o=n.options)||void 0===o?void 0:o.wheelPropagation)&&void 0!==r?r:n.wheelStop}),y=function(n){return null==p?void 0:p.map(function(t,o){var r;return(null!==(r=t.mountPosition)&&void 0!==r?r:"outside")===n&&t.render&&e.createElement("div",{key:o,className:"scrollbar-plugin ".concat(n)},t.render())})};return e.createElement("div",{id:n.id,className:h,style:a(a({},n.style),n.injectTable?{}:v),onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)}},y("before"),e.createElement("div",{ref:s,className:m},n.children,y("inside")),y("outside"))});R.displayName="Scrollbar";var k=function(e){var n=void 0===e?{}:e,t=n.distance,o=void 0===t?80:t,r=n.duration,l=void 0===r?400:r,i=n.borderColor,c=void 0===i?"#40a9ff":i,a=n.borderWidth,s=void 0===a?1.5:a,u=n.borderDuration,d=void 0===u?250:u,v=null,f=null,p=0,h=!1,m=function(){if(v){p*=.8;var e=v.scrollHeight-v.clientHeight,n=p;v.scrollTop+p>e&&(n=e-v.scrollTop),v.scrollTop+p<0&&(n=-v.scrollTop),v.style.transform="translateY(".concat(n,"px)"),!h&&Math.abs(p)>0&&(v.style.border="".concat(s,"px solid ").concat(c),h=!0),Math.abs(p)>1?f=requestAnimationFrame(m):(v.style.transition="transform ".concat(l,"ms ease-out, border ").concat(d,"ms"),v.style.transform="translateY(0)",setTimeout(function(){v&&(v.style.transform="",v.style.transition="",v.style.border="",h=!1)},Math.max(l,d)),f=null,p=0)}};return{onInit:function(e,n){(v=n.firstElementChild)||console.warn("bounce plugin: wrapper not found")},onScroll:function(e){if(v){var n=e.scrollTop,t=v.scrollHeight,r=v.clientHeight,l=n-parseFloat(e.dataset.lastScroll||"0");n<=0&&l<0?p=Math.max(l,-o):n+r>=t&&l>0&&(p=Math.min(l,o)),0===p||f||m(),e.dataset.lastScroll=n.toString()}},onDestroy:function(){f&&cancelAnimationFrame(f),v&&(v.style.transform="",v.style.border=""),v=null,f=null,p=0,h=!1}}},F=function(e){var n=void 0===e?{}:e,t=n.distance,o=void 0===t?20:t,r=n.duration,l=void 0===r?300:r,i=null,c=null,a=0,s=function(e){if(i){var n=performance.now(),t=function(o){var r=Math.min((o-n)/l,1),a=Math.sin(r*Math.PI/2);i.style.transform="translateY(".concat(e*(1-a),"px)"),r<1?c=requestAnimationFrame(t):(i.style.transform="",c=null)};c=requestAnimationFrame(t)}};return{onInit:function(e,n){(i=n.firstElementChild)||console.warn("bounce plugin: wrapper not found"),a=n.scrollTop},onScroll:function(e){if(i){var n=e.scrollTop,t=e.scrollHeight,r=e.clientHeight,l=n-a;n<=0&&l<0?s(o):n+r>=t&&l>0&&s(-o),a=n}},onDestroy:function(){c&&cancelAnimationFrame(c),i&&(i.style.transform=""),i=null,c=null}}},D=function(e){var n=void 0===e?{}:e,t=n.gradientSize,o=void 0===t?30:t,r=n.gradientColor,l=void 0===r?"rgba(0,0,0,0.1)":r,i=n.zIndex,c=void 0===i?1e3:i,a=null,s=null,u=null,d=null,v=function(){if(a&&s&&u){var e=a.scrollTop,n=a.scrollHeight,t=a.clientHeight;s.style.opacity=e>0?"1":"0";var r=n-(e+t);u.style.opacity=r>1?"1":"0",u.style.top="".concat(e+t-o,"px"),d=null}};return{onInit:function(e,n){(a=n).style.position&&"static"!==a.style.position||(a.style.position="relative"),s=n.querySelector("[data-gradient-top]"),u=n.querySelector("[data-gradient-bottom]"),s||((s=document.createElement("div")).setAttribute("data-gradient-top","true"),Object.assign(s.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"".concat(o,"px"),background:"linear-gradient(to bottom, ".concat(l,", transparent)"),pointerEvents:"none",transition:"opacity 0.3s",zIndex:c.toString()}),n.appendChild(s)),u||((u=document.createElement("div")).setAttribute("data-gradient-bottom","true"),Object.assign(u.style,{position:"absolute",left:"0",width:"100%",height:"".concat(o,"px"),background:"linear-gradient(to top, ".concat(l,", transparent)"),pointerEvents:"none",transition:"opacity 0.3s",zIndex:c.toString()}),n.appendChild(u)),v()},onScroll:function(){null===d&&(d=requestAnimationFrame(v))},onDestroy:function(){s&&s.remove(),u&&u.remove(),a=null,s=null,u=null,d&&cancelAnimationFrame(d),d=null}}},q=function(e){var n=void 0===e?{}:e,t=n.itemSelector,o=void 0===t?"li":t,r=n.highlightClass,l=void 0===r?"ps-scroll-highlight":r,i=null,c=null,a=null,s=function(){if(i){var e=i.scrollTop+i.clientHeight/2,n=Array.from(i.querySelectorAll(o));if(n.length){for(var t=n[0],r=Math.abs(n[0].offsetTop-e),a=0,s=n;a<s.length;a++){var u=s[a],d=Math.abs(u.offsetTop-e);d<r&&(r=d,t=u)}c&&c.classList.remove(l),t.classList.add(l),c=t}}};return{onInit:function(e,n){i=n,s()},onScroll:function(){a&&cancelAnimationFrame(a),a=requestAnimationFrame(s)},onDestroy:function(){c&&c.classList.remove(l),i=null,c=null,a&&cancelAnimationFrame(a),a=null}}},C=function(e){var n=void 0===e?{}:e,t=n.momentumRef,o=void 0===t?{vx:0,vy:0,raf:null}:t,r=n.friction,l=void 0===r?.95:r,i=null,c=function(e){o&&(Math.abs(o.vx)<.1&&Math.abs(o.vy)<.1?o.raf=null:(e.scrollLeft+=o.vx,e.scrollTop+=o.vy,o.vx*=l,o.vy*=l,o.raf=requestAnimationFrame(function(){return c(e)})))};return{onInit:function(e,n){o.raf||(i=requestAnimationFrame(function(){return c(n)}))},onScroll:function(e){var n,t,r=e.scrollLeft-(null!==(n=o.vx)&&void 0!==n?n:0),l=e.scrollTop-(null!==(t=o.vy)&&void 0!==t?t:0);o.vx=r,o.vy=l},onDestroy:function(){i&&cancelAnimationFrame(i)}}},O=function(n){var r=n.threshold,l=void 0===r?60:r,i=n.onLoadMore,c=n.onCompleted,a=n.loading,d=void 0===a?e.createElement(e.Fragment,null,"Loading..."):a,v=n.done,f=void 0===v?e.createElement(e.Fragment,null,"Done!"):v,p=n.completed,h=void 0===p?e.createElement(e.Fragment,null,"No more data"):p,m=n.doneDelay,y=void 0===m?1e3:m,g=n.lockWhileLoading,b=void 0!==g&&g,S=n.onError,E=null,w=!1,x=!1,T=null,L=null;function A(){var n=t("idle"),r=n[0],l=n[1];return o(function(){return T=l,function(){T=null}},[]),"loading"===r?e.createElement("div",{className:"ps-scrollbar-loadmore-loader"},d):"done"===r?e.createElement("div",{className:"ps-scrollbar-loadmore-done"},f):"completed"===r?e.createElement("div",{className:"ps-scrollbar-loadmore-completed"},h):null}return{mountPosition:"inside",render:function(){return e.createElement(A,null)},onInit:function(e,n){E=n},onScroll:function(){return s(this,void 0,void 0,function(){var e,n,t,o,r;return u(this,function(a){switch(a.label){case 0:if(!E||w||x)return[2];if(e=E.scrollTop,n=E.scrollHeight,t=E.clientHeight,!(l<1?e+t>=n*l:e+t>=n-l))return[2];w=!0,null==T||T("loading"),b&&(E.style.pointerEvents="none"),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,i()];case 2:return void 0===(o=a.sent())&&(o=!0),o?(null==T||T("done"),L&&clearTimeout(L),L=window.setTimeout(function(){null==T||T("idle"),L=null},y)):(x=!0,null==T||T("completed"),null==c||c()),[3,5];case 3:return r=a.sent(),null==S||S(r),null==T||T("idle"),[3,5];case 4:return b&&(E.style.pointerEvents=""),w=!1,[7];case 5:return[2]}})})},onDestroy:function(){E=null,w=!1,x=!1,T=null,L&&(clearTimeout(L),L=null)}}},P=function(n){var t=n.state,o=n.loading,r=n.done;return"loading"===t?e.createElement("div",{className:"ps-scrollbar-ptr-loader"},o):"done"===t?e.createElement("div",{className:"ps-scrollbar-ptr-done"},r):e.createElement("div",{className:"ps-scrollbar-ptr-placeholder"})},j=function(n){var r,l=n.threshold,i=void 0===l?60:l,c=n.onRefresh,a=n.loading,d=void 0===a?e.createElement(e.Fragment,null,"🔄 Loading..."):a,v=n.done,f=void 0===v?e.createElement(e.Fragment,null,"✅ Done!"):v,p=n.doneDuration,h=void 0===p?500:p,m=n.lockScrollWhileLoading,y=void 0===m||m,g=null,b=null,S=null,E=null,w=null,x=!1,T=!1,L=null,A=0,H=0,M="number"==typeof i?i:60,I=null,R=function(){b&&(b.style.transition="transform 0.3s",b.style.transform="translateY(0px)",setTimeout(function(){b&&(b.style.transition="")},300)),H=0,null==r||r("idle")},k=function(e,n){g&&!x&&(g.scrollTop>0||(T=!0,A=e,"number"==typeof n&&(L=n)))},F=function(e,n){if(T&&g&&b&&!x){var t=e-A;if(t<=0)H>0&&R();else{if(n&&"preventDefault"in n)try{n.preventDefault()}catch(e){}H=Math.min(.5*t,2*M),b.style.transform="translateY(".concat(H,"px)")}}},D=function(){return s(void 0,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:if(!T||!g||!b)return T=!1,L=null,[2];if(T=!1,L=null,!(H>=M)||x)return[3,6];x=!0,y&&(w=g.style.pointerEvents||null,g.style.pointerEvents="none"),b.style.transition="transform 0.3s",b.style.transform="translateY(".concat(M,"px)"),null==r||r("loading"),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,c()];case 2:return e.sent(),null==r||r("done"),[3,5];case 3:return e.sent(),null==r||r("idle"),[3,5];case 4:return I&&clearTimeout(I),I=window.setTimeout(function(){R(),y&&g&&(g.style.pointerEvents=null!==w?w:""),x=!1,I=null},h),[7];case 5:return[3,7];case 6:R(),e.label=7;case 7:return[2]}})})},q=function(e){if(!x&&g&&!(g.scrollTop>0)){k(e.clientY,e.pointerId);try{g.setPointerCapture(e.pointerId)}catch(e){}}},C=function(e){T&&(null!=L&&e.pointerId!==L||F(e.clientY,e))},O=function(e){if(null!=L)try{null==g||g.releasePointerCapture(L)}catch(e){}D()},j=function(e){if(null!=L)try{null==g||g.releasePointerCapture(L)}catch(e){}T=!1,L=null,R()},z=function(e){!e.touches||e.touches.length>1||!g||x||g.scrollTop>0||k(e.touches[0].clientY)},N=function(e){T&&F(e.touches[0].clientY,e)},Y=function(){return D()},W=function(e){0===e.button&&(!g||x||g.scrollTop>0||(k(e.clientY),document.addEventListener("selectstart",X)))},B=function(e){T&&F(e.clientY,e)},U=function(){document.removeEventListener("selectstart",X),D()},X=function(e){return e.preventDefault()},K=function(){var n=t("idle"),l=n[0],i=n[1];return o(function(){return r=i,function(){r=void 0}},[]),e.createElement("div",{className:"ps-scrollbar-ptr",style:{position:"absolute",top:0,left:0,right:0,height:"60px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}},e.createElement(P,{state:l,loading:d,done:f}))};return{mountPosition:"before",render:function(){return e.createElement(K,null)},onInit:function(e,n){g=n,b=n.querySelector(".ps__content")||n.firstElementChild||null;var t=window.getComputedStyle(g).position;S=g.style.position||null,["relative","absolute","fixed"].includes(t)||(g.style.position="relative"),E=g.style.overscrollBehavior||"",g.style.overscrollBehavior="contain",g.style.touchAction="pan-y",b&&(b.style.willChange="transform"),M=i<1?Math.max(30,Math.round(g.clientHeight*i)):i,g.style.setProperty("--ps-ptr-threshold","".concat(M,"px")),g.addEventListener("pointerdown",q),g.addEventListener("pointermove",C),g.addEventListener("pointerup",O),g.addEventListener("pointercancel",j),g.addEventListener("touchstart",z,{passive:!1}),g.addEventListener("touchmove",N,{passive:!1}),g.addEventListener("touchend",Y),g.addEventListener("mousedown",W),document.addEventListener("mousemove",B),document.addEventListener("mouseup",U)},onScroll:function(){!x&&g&&g.scrollTop>0&&H>0&&R()},onDestroy:function(){g&&(g.removeEventListener("pointerdown",q),g.removeEventListener("pointermove",C),g.removeEventListener("pointerup",O),g.removeEventListener("pointercancel",j),g.removeEventListener("touchstart",z),g.removeEventListener("touchmove",N),g.removeEventListener("touchend",Y),g.removeEventListener("mousedown",W),document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",U),document.removeEventListener("selectstart",X),b&&(b.style.transform="",b.style.transition="",b.style.willChange=""),g&&(null!==S&&(g.style.position=S),g.style.overscrollBehavior=null!==E?E:"",g.style.removeProperty("--ps-ptr-threshold"),g.style.touchAction="",null!==w&&(g.style.pointerEvents=w),g=null),I&&(clearTimeout(I),I=null),x=!1,T=!1,L=null,A=0,H=0,r=void 0)}}},z=function(e){var n=void 0===e?{}:e,t=n.threshold,o=void 0===t?.9:t,r=n.callbacks,l=void 0===r?{}:r;return{onScroll:function(e){var n,t;e.scrollTop<=0&&(null===(n=null==l?void 0:l.onTop)||void 0===n||n.call(l)),(o<1?e.scrollTop+e.clientHeight>=e.scrollHeight*o:e.scrollTop+e.clientHeight>=e.scrollHeight-o)&&(null===(t=null==l?void 0:l.onBottom)||void 0===t||t.call(l))}}},N=function(e){var n=void 0===e?{}:e,t=n.itemSelector,o=void 0===t?"div":t,r=n.snapDelay,l=void 0===r?100:r,i=null;return{onScroll:function(e){i&&clearTimeout(i),i=window.setTimeout(function(){!function(e){var n=Array.from(e.querySelectorAll(o));if(n.length){var t=e.scrollTop,r=n.reduce(function(e,n){return Math.abs(n.offsetTop-t)<Math.abs(e.offsetTop-t)?n:e});r&&h(e,r.offsetTop,{duration:200})}}(e)},l)},onDestroy:function(){i&&clearTimeout(i)}}},Y=function(e){var n=void 0===e?{}:e,t=n.leftColumns,o=void 0===t?0:t,r=n.rightColumns,l=void 0===r?0:r,i=n.zIndex,c=void 0===i?10:i,a=n.background,s=void 0===a?"#fff":a,u=null;return{onInit:function(e,n){u=n.querySelector("table"),function(){if(u){for(var e=Array.from(u.querySelectorAll("thead th")),n=Array.from(u.querySelectorAll("tbody tr")),t=e.map(function(e){return e.getBoundingClientRect().width}),r=function(o){var r=e[o],l=t.slice(0,o).reduce(function(e,n){return e+n},0);r.style.position="sticky",r.style.left=l+"px",r.style.zIndex=c.toString(),r.style.background=s,n.forEach(function(e){var n=e.children[o];n.style.position="sticky",n.style.left=l+"px",n.style.zIndex=(c-1).toString(),n.style.background=s})},i=0;i<o;i++)r(i);var a=function(o){var r=e.length-1-o,l=e[r],i=t.slice(r+1).reduce(function(e,n){return e+n},0);l.style.position="sticky",l.style.right=i+"px",l.style.zIndex=c.toString(),l.style.background=s,n.forEach(function(e){var n=e.children[r];n.style.position="sticky",n.style.right=i+"px",n.style.zIndex=(c-1).toString(),n.style.background=s})};for(i=0;i<l;i++)a(i)}}()},onDestroy:function(){u&&(Array.from(u.querySelectorAll("th, td")).forEach(function(e){e.style.position="",e.style.left="",e.style.right="",e.style.zIndex="",e.style.background=""}),u=null)}}},W=function(e){var n=void 0===e?{}:e,t=n.zIndex,o=void 0===t?10:t,r=n.background,l=void 0===r?"#fff":r,i=null;return{onInit:function(e,n){(i=n.querySelector("thead"))&&(i.style.position="sticky",i.style.top="0",i.style.zIndex=o.toString(),i.style.background=l)},onDestroy:function(){i&&(i.style.position="",i.style.top="",i.style.zIndex="",i.style.background=""),i=null}}};export{P as PullToRefresh,h as animateScrollTo,y as animateScrollToBottom,g as animateScrollToTop,m as animateScrollToX,w as appendDimension,x as appendEventListener,k as bounceEffectPlugin,F as bounceHighlightPlugin,H as calculatorRealSize,b as callPlugins,T as clearEventListener,S as createScrollbarApi,R as default,M as find1stLevel,L as findTargetTable,D as gradientIndicatorPlugin,q as highlightItemPlugin,C as inertiaPlugin,O as loadMorePlugin,A as psHtmlListSize,j as pullToRefreshPlugin,z as scrollSpyPlugin,N as snapToItemPlugin,d as startMomentumScroll,Y as stickyColumnsPlugin,W as stickyHeaderPlugin,I as useScrollbarCore};
